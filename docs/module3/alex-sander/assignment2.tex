%!TEX program = xelatex+makeindex+bibtex
\documentclass[final]{scrreprt} %scrreprt of scrartcl
\input{../../library/preamble.tex}
\input{../../library/style.tex}
\addbibresource{../../library/bibliography.bib}
\usepackage{amsmath}
\usepackage{graphicx}
\title{Module 3 - Report}
\author{Alex {Misdorp} \and Sander {van Dijk}}
\begin{document}

\chapter{Assignment 2}
\section*{Task 3: Identifying the models' parameters}

Now that a model has been constructed we need to find the values for our A and B matrix. To find these we sent the car a signal and measured the output of the ultrasound sensors. In figure \ref{fig:KITT-input-output-model} the results are on display.
The blue signal represents the input signal and periodically goes above $x=0$ and beneath it. In between those transitions there will be a small delay where the input remains zero for a while. The model output will react accordingly whereby the postion increases for a positive input and decreases for a negative input.
The output signal from KITT shows a phase shift which might be contributed to the car's acceleration that is not instantaneous, there will be a certain delay. The jerking of the red line might also be contributed to this.

\begin{figure}[H]
	\centering
    	\setlength\figureheight{4cm}
    	\setlength\figurewidth{0.8\linewidth}
    	\input{res/KITT-input-output-model-output.tikz}    	
    	\caption{The simulation and the car's response.}
    	\label{fig:KITT-input-output-model}
\end{figure}

The measurements resulted in the following A matrix and associated eigenvalues.

\begin{equation}
A=
\begin{bmatrix}
  0 & 1 \\
  -2,5245 & -2,0240
 \end{bmatrix}
\qquad
eig(A)=
\begin{bmatrix}
 -1.0120 + 1.2249i \\
  -1.0120 - 1.2249i
 \end{bmatrix}
\end{equation}

Because the real part of the eigenvalues are non positive the system appears to be stable. Generally speaking the simulation is a pretty good approximation whereby the phase shift should be kept in mind.

\section*{Task 4: Observer Design}
In order to get accurate information about the velocity of the car, an observer is constructed. Both poles have been set a -20, determining the poles was a bit of a trial and error process. The main requirement is that the poles are located in the left plane. The more negative the real part of a pole is, the stronger the damping. However choosing the poles to far to the left is not practical. Using MatLab and setting the poles at -20 we calculated the following L matrix:
\begin{equation}
L=
\begin{bmatrix}
  37.238 \\
  705.24
 \end{bmatrix}
\end{equation}

With the use of Simulink we build a model to test our observer, it can be found in \ref{app:model}.
As seen in figure \ref{ result the observer tracks the velocity fairly well. This can be seen in figure \ref{fig:observer} where the pink line represent the actual velocity and the blue line the observed velocity. 

\begin{figure}[H]
\centering
\includegraphics[width=\linewidth]{res/observer-res.png}
\caption{Observer at work.}
\label{fig:observer}
\end{figure}

After about 1,5 seconds there is only a slight difference between the two lines and after two seconds they are nearly identical. This is in agreement with the requirements for an observer; the difference $x(t)-\hat{x}$ converges to zero and after a certain time point $t_i$ where $x(t) = \hat{x}$, this equation remains satisfied for $t$\geq $t_i$.

\section*{Task 5: Controller design}

To obtain oscillatory behavior we chose poles at X and Y. This results in the following K matrix:
\begin{equation}
\centering
K = 
\begin{bmatrix}
  XXX & XXX
\end{bmatrix}
\end{equation}
Leading to the oscillatory response as seen in figure \ref{fig:oscillatory}.

\begin{figure}[h!]
\centering
\includegraphics[scale = 0.5]{res/osc2-res.png}
\caption{Oscillatory behaviour.}
\label{fig:oscillatory}
\end{figure}

To obtain the desired critically damped response we had to choose our poles in the left half-plane. One would not want the poles to be too close to zero which might cause stability issues, on the other hand one would not want to place the poles too far to the left because this might not be practically feasible. Therefore we chose our poles at $-1+100i$ and $1+101i$. This results in the following K matrix:
\begin{equation}
\centering
K =
\begin{bmatrix}
  0 & 0,8
\end{bmatrix}
\end{equation}

Using this K matrix we receive a critically damped response as seen in figure \ref{fig:critically}.

\begin{figure}[H]
\centering
\includegraphics[scale = 0.5]{res/critically-res.png}
\caption{Critically damped behaviour.}
\label{fig:critically}
\end{figure}

In accordance to the preceding figure we obtain the desired closed loop behaviour in our simulation.
\end{document}