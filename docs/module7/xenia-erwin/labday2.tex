\documentclass[final]{scrreprt} %scrreprt of scrartcl
\input{../../library/preamble.tex}
\input{../../library/style.tex}
\addbibresource{../../library/bibliography.bib}

\begin{document}

\chapter{Labday 2: Channel Estimation}
\label{ch:labday2}

\section{Channel estimation using a training sequence}

We have to look at four different test signals:

\begin{itemize}
\item 	A "minimium-phase" sequence, 
\begin{equation}
X_1(z) = 1 - \dfrac{1}{2}Z^{-1} \leftrightarrow x_1 = [1, -\dfrac{1}{2}, 0, 0,  \dots]^T
\end{equation}
\item A "maximum-phase" sequence,
\begin{equation}
X_2(z) = 1 - 2z^{-1} \leftrightarrow x_2 = [1, -2, 0, 0, \dots]^T
\end{equation}
\item A sinusoidal signal (N samples) followed by zeros,
\[ x_3[n] = \left\{ 
  \begin{array}{l l}
    \cos(\omega n), & \quad n = 0, \dots ,N - 1\\
    0, & \quad \textrm{elsewhere}
  \end{array} \right.\]
\item A random BPSK sequence (i.e., with entries randomly selected from {-1,1}: in Matlab),
\begin{equation}
x_4 = sign(randn(N,1))
\end{equation}
\end{itemize}

These four signals ..

Two Matlab functions, \texttt{ch1.m} and \texttt{ch2.m} respectively, are written. 
\texttt{ch1.m} implements the time-domain channel estimation using inversion and \texttt{ch2.m} implements a matched filter.
The scripts for these functions can be found in Appendix \ref{lst:ch1.m} and Appendix \ref{lst:ch2.m}.
With the help of the input $x[n]$, the output $y[n]$ and the channel length $L$ these two functions approach the $\hat{h}[n]$ filter. 
For the implementation of these two functions we also need the Toeplitz-matrix. 
We can call upon the Toeplitz matrix by using \texttt{toep.m}. 
The script for the Toeplitz-matrix can be found in Appendix \ref{lst:toep.m}.

\subsection{Autocorrelation of the input signals}

\begin{figure}[H]
	\centering
    	\setlength\figureheight{6cm}
    	\setlength\figurewidth{10cm}
    	\input{resources/autocorrelatie1.tikz}    	
    	\caption{Autocorrelation of \texttt{x1}}
    	\label{fig:auto1}
\end{figure}
\begin{figure}[H]
	\centering
    	\setlength\figureheight{6cm}
    	\setlength\figurewidth{10cm}
    	\input{resources/autocorrelatie2.tikz}    	
    	\caption{Autocorrelation of \texttt{x2}}
    	\label{fig:auto2}
\end{figure}
\begin{figure}[H]
	\centering
    	\setlength\figureheight{6cm}
    	\setlength\figurewidth{10cm}
    	\input{resources/autocorrelatie3_3.tikz}    	
    	\caption{Autocorrelation of \texttt{x3}}
    	\label{fig:auto3}
\end{figure}
\begin{figure}[H]
	\centering
    	\setlength\figureheight{6cm}
    	\setlength\figurewidth{10cm}
    	\input{resources/autocorrelatie4_3.tikz}    	
    	\caption{Autocorrelation of \texttt{x4}}
    	\label{fig:auto4}
\end{figure}

\subsection{Singular values of the input signals}

\begin{figure}[H]
	\centering
    	\setlength\figureheight{6cm}
    	\setlength\figurewidth{10cm}
    	\input{resources/svd1.tikz}    	
    	\caption{Singular values of \texttt{x1}}
    	\label{fig:auto1}
\end{figure}

\begin{figure}[H]
	\centering
    	\setlength\figureheight{6cm}
    	\setlength\figurewidth{10cm}
    	\input{resources/svd2.tikz}    	
    	\caption{Singular values of \texttt{x2}}
    	\label{fig:auto1}
\end{figure}

\begin{figure}[H]
	\centering
    	\setlength\figureheight{6cm}
    	\setlength\figurewidth{10cm}
    	\input{resources/svd3.tikz}    	
    	\caption{Singular values of \texttt{x3}}
    	\label{fig:auto1}
\end{figure}

\begin{figure}[H]
	\centering
    	\setlength\figureheight{6cm}
    	\setlength\figurewidth{10cm}
    	\input{resources/svd4.tikz}    	
    	\caption{Singular values of \texttt{x4}}
    	\label{fig:auto1}
\end{figure}

\subsection{Error criterion}

\begin{figure}[H]
	\centering
    	\setlength\figureheight{6cm}
    	\setlength\figurewidth{10cm}
    	\input{resources/error_0.01.tikz}    	
    	\caption{Singular values of \texttt{x3}}
    	\label{fig:auto1}
\end{figure}

\begin{figure}[H]
	\centering
    	\setlength\figureheight{6cm}
    	\setlength\figurewidth{10cm}
    	\input{resources/error_0.01_2.tikz}    	
    	\caption{Singular values of \texttt{x4}}
    	\label{fig:auto1}
\end{figure}


\subsection{Cross-correlation}
\begin{figure}[H]
	\centering
    	\setlength\figureheight{6cm}
    	\setlength\figurewidth{10cm}
    	\input{resources/crossx1.tikz}    	
    	\caption{The cross-correlation of \texttt{x1} with other signals.}
    	\label{fig:auto1}
\end{figure}

\begin{figure}[H]
	\centering
    	\setlength\figureheight{6cm}
    	\setlength\figurewidth{10cm}
    	\input{resources/crossx2.tikz}    	
    	\caption{The cross-correlation of \texttt{x2} with other signals.}
    	\label{fig:auto1}
\end{figure}

\begin{figure}[H]
	\centering
    	\setlength\figureheight{6cm}
    	\setlength\figurewidth{10cm}
    	\input{resources/crossx3.tikz}    	
    	\caption{The cross-correlation of \texttt{x3} with other signals.}
    	\label{fig:auto1}
\end{figure}

\begin{figure}[H]
	\centering
    	\setlength\figureheight{6cm}
    	\setlength\figurewidth{10cm}
    	\input{resources/crossx4.tikz}    	
    	\caption{The cross-correlation of \texttt{x4} with other signals.}
    	\label{fig:auto1}
\end{figure}
\end{document} 